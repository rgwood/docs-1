---
title: 'Syncing Data'
sidebar_position: 7
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import SnippetGroup from '@site/src/components/SnippetGroup';

By default, Ditto will not sync data with other devices.  When the device is
observing a query, it requests to synchronize data that matches the query from
other devices in the mesh network. 

In other words, when a live query is created, Ditto's sync system
**pulls** data from other devices. There is no way to "push" data through the
API explicitly. Devices select data they are interested in through the query
system and then synchronize with the mesh network based on that query.

![Query-based Subscriptions](syncing_data_1.jpeg)

## Sync

To enable Ditto to sync data, you'll need to call `ditto.tryStartSync()`. 

Preferably, you should call `tryStartSync()` early on in your application's life cycle like in your `AppDelegate.application(_:didFinishLaunchingWithOptions:)` or `Application.onCreate` methods. Your application only needs to call this function once.

<SnippetGroup
  name='sync-basic' 
/>

## Observe

Create a query with `.observe` to get notified when data changes. [Learn more about how to create queries](./querying)

:::caution
If the `liveQuery` object is deallocated the live query will stop. For long
running queries, store them in an object.
:::

<SnippetGroup name="sync-observe" />


* Call `.observe` after `ditto.tryStartSync()` to synchronize and download real-time data from other peers.
* The callback will immediately run for documents that fit the query.
* The callback will get called with both local and remote changes that fit the query. 
* The callback will rerun for each sync or write transaction.
* You can create as many `LiveQuery` objects as you want.
* To manually stop the `liveQuery`, set it either to `null` or call `liveQuery.stop()`


## Subscribe

Having a subscription acts as a signal to other peers that you are interested in
receiving updates when local or remote changes are made to
documents that match the query generated by the chain of operations that
precedes the call to `subscribe`.

The returned Subscription object must be kept in scope for as long as
you want to keep receiving updates. Subscribe is different than `observe`
because a callback is not required. This can be more memory efficient. This function is useful if you're just interested in subscribing to changes on a query to have a local offline copy of the data, but do not want to operate on the results.

<SnippetGroup name="subscribe" />

## Multi-hop replication

Given that Ditto works peer-to-peer, devices can form into arbitrary groups
based on the proximity to one another, or rather they create an ad-hoc mesh
network. Ditto's sync system allows for devices to share data through another
device, called "multi-hop" sync. The only requirement for this to occur is that
all devices in the chain must be observing the same data, as shown below:

![Multi-hop Subscriptions](syncing_data_2_same_query.jpeg)

## Live Queries without Syncing Data

There are many situations where your app needs to observe live queries _without_
initiating syncing with other devices. For example, this is useful if your app
intends to treat certain documents and collections as local-only data.

Instead of `.observe`, call `.observeLocal` like so:

<SnippetGroup name="sync-observe-local" />

Note: if your Ditto instance has not called `tryStartSync`, there will be no difference between `.observe` and `.observeLocal`.


## Observing Peers 

There could be a situation where you need to know the device names of peers you
are connected to. You can manually set the device name of those peers and
observe those peers in the network.

<SnippetGroup name="device-name" />

Because ditto is a pull-based sync system, each device observes changes that
other devices have made. If you want to observe changes made by a particular
device, include the device name as a field in the document and query for that field in
your [ditto live query](./querying)

```
"status == 'open' && edited_by == 'deviceC'"
```
